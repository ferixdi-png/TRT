# UX Blueprint (Production Contract)

## Главный принцип
* **Все можно сделать кнопками**, но пользователь может отвечать текстом или файлом.
* Любое действие пользователя получает явный ответ.
* В каждом экране доступны пути **Назад**, **Главное меню**, **Отмена**.

## Стандартные состояния

### 1) Главное меню
**Показываем:**
* Текст приветствия и краткую подсказку.
* Кнопки выбора типа генерации/моделей.
* Кнопки служебных разделов: баланс, помощь, поддержка.

**Кнопки:**
* «Генерация» / «Модели» (или категории)
* «Баланс»
* «Помощь» / «Поддержка»

**Переходы:**
* Любой выбор типа/модели → Wizard Step 1.

### 2) Экран выбора типа/модели
**Показываем:**
* Название модели и короткое описание.
* Стоимость.
* Кнопку «Сгенерировать».

**Кнопки:**
* «Сгенерировать»
* «Назад» → предыдущее меню
* «Главное меню» → safe reset
* «Отмена» → safe reset

### 3) Wizard-экран (шаг ввода)
**Показываем:**
* Что требуется сейчас (текст/фото/аудио/документ).
* Подсказку по формату.
* Какие параметры уже выставлены и какие значения по умолчанию.

**Кнопки:**
* «Назад» → откат шага
* «Главное меню» → safe reset
* «Отмена» → reset
* «Изменить настройки» (если есть optional параметры)

**Переходы:**
* Валидный ввод → следующий шаг.
* Невалидный ввод → объяснение + повтор запроса.

### 4) Экран подтверждения
**Показываем:**
* Сводку параметров.
* Стоимость.

**Кнопки:**
* «Подтвердить» → генерация
* «Назад» → последний шаг
* «Главное меню» → safe reset
* «Отмена» → reset

### 5) Экран прогресса
**Показываем:**
* «Принято → Генерирую → Готово».

**Кнопки:**
* «Главное меню»

### 6) Экран результата
**Показываем:**
* Итоговый результат (photo/video/audio/document/text)
* Инструкции, если есть fallback.

**Кнопки:**
* «Сгенерировать ещё»
* «Главное меню»

## Ошибки (единый UX)
* Любая ошибка возвращает понятный текст + рекомендацию.
* Ошибка логируется с `error_code` и `fix_hint`.

## Safe Reset
* `/start` и «Главное меню» всегда сбрасывают wizard, но **не** сбрасывают баланс и рефералку.
* «Отмена» всегда сбрасывает wizard и возвращает в меню.

## Типы ввода
* **Text** → проверка длины/формата.
* **Photo** → принимается фото/картинка, и только это.
* **Audio** → принимается голос/аудио.
* **Document** → принимается файл, если требуется.

## Fallback поведение
* Для устаревших кнопок: «Кнопка устарела, обновил меню» → главное меню.
* Для неподдерживаемого формата: «Нужен формат X, попробуйте отправить Y».
