# Текущее состояние

## Готовность интегратора
- **Код готов к работе при наличии ключей**: все обязательные обработчики покрыты smoke-тестами, регистр моделей фильтруется по включённым тарифам.
- **Стабильность**: локально проходят 6 smoke-тестов и 3 скипа (`pytest tests/test_flow_smoke.py -q`), тесты используют заглушки токенов, так что запуск возможен без реальных секретов.

## Что нужно для рабочей генерации
- Укажите реальные переменные окружения: `TELEGRAM_BOT_TOKEN`, `KIE_API_KEY`, `DATABASE_URL`, `ADMIN_ID`, `BOT_MODE=webhook`, `WEBHOOK_BASE_URL=https://<ваш-домен>`. Без них бот не пройдёт инициализацию и не сможет принимать вебхуки.
- Запускайте сервис стандартно: `pip install -r requirements.txt`, затем `python main_render.py` (webhook-режим с health-check уже встроен).

## Если генерация "не идёт"
- Проверьте, что `BOT_MODE` стоит в `webhook`, а `WEBHOOK_BASE_URL` совпадает с публичным URL сервиса.
- Добавьте `TELEGRAM_WEBHOOK_SECRET_TOKEN` и `LOG_LEVEL=DEBUG` для быстрой диагностики доставки апдейтов.
- Убедитесь, что БД и веб-сервис находятся в одном регионе (для Render это снижает задержки и таймауты webhook-запросов).
- При необходимости перезапустите sync моделей (команда `python parse_all_models.py`) и повторно выставьте вебхук через `main_render.py`.
